{"paragraphs":[{"text":"%pyspark\nfrom pyspark.mllib.linalg import Vectors\nfrom pyspark.ml.feature import StandardScaler\nfrom pyspark.ml import Pipeline\nfrom pyspark.sql import Row\nfrom pyspark.ml.clustering import KMeans, KMeansModel\nfrom pyspark.ml.tuning import TrainValidationSplit\nfrom pyspark.sql import SQLContext\nfrom pyspark.sql.functions import col, mean\nfrom pyspark.sql.types import *\nfrom pyspark.ml.feature import VectorAssembler\nfrom pyspark.ml.evaluation import ClusteringEvaluator\n","user":"anonymous","dateUpdated":"2019-02-18T23:49:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550351381143_-30248877","id":"20190216-053052_2038991814","dateCreated":"2019-02-16T21:09:41+0000","dateStarted":"2019-02-18T23:49:39+0000","dateFinished":"2019-02-18T23:49:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5811"},{"text":"%pyspark\nsqlContext = SQLContext(sc)\ndf = sqlContext.read.format('com.databricks.spark.csv').options(header='true', inferschema='true').load('hdfs:///user/training/bigdata/Uber.csv')","user":"anonymous","dateUpdated":"2019-02-18T23:50:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=38","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=39"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550351381143_-2059345833","id":"20190216-053107_906221807","dateCreated":"2019-02-16T21:09:41+0000","dateStarted":"2019-02-18T23:50:04+0000","dateFinished":"2019-02-18T23:50:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5812"},{"text":"%pyspark\ndf.show()","user":"anonymous","dateUpdated":"2019-02-16T21:22:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-------+--------+------+\n|          Date/Time|    Lat|     Lon|  Base|\n+-------------------+-------+--------+------+\n|2014-08-01 00:00:00|40.7476|-73.9871|B02598|\n|2014-08-01 00:00:00|40.7424|-74.0044|B02598|\n|2014-08-01 00:00:00| 40.751|-73.9869|B02598|\n|2014-08-01 00:00:00|40.7406|-73.9902|B02598|\n|2014-08-01 00:00:00|40.6994|-73.9591|B02617|\n|2014-08-01 00:00:00|40.6917|-73.9398|B02617|\n|2014-08-01 00:00:00|40.7063|-73.9223|B02617|\n|2014-08-01 00:00:00|40.6759|-74.0168|B02617|\n|2014-08-01 00:00:00|40.7617|-73.9847|B02617|\n|2014-08-01 00:00:00|40.6969|-73.9064|B02617|\n|2014-08-01 00:00:00|40.7623|-73.9751|B02617|\n|2014-08-01 00:00:00|40.6982|-73.9669|B02617|\n|2014-08-01 00:00:00|40.7553|-73.9253|B02617|\n|2014-08-01 00:00:00|40.7325|-73.9876|B02682|\n|2014-08-01 00:00:00|40.6754| -74.017|B02682|\n|2014-08-01 00:00:00|40.7303|-74.0029|B02682|\n|2014-08-01 00:00:00|40.7218|-73.9973|B02682|\n|2014-08-01 00:00:00|40.7134|-74.0091|B02682|\n|2014-08-01 00:00:00|40.7194|-73.9964|B02682|\n|2014-08-01 00:00:00| 40.762| -73.983|B02682|\n+-------------------+-------+--------+------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=187"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550351381143_509076001","id":"20190216-053221_794255246","dateCreated":"2019-02-16T21:09:41+0000","dateStarted":"2019-02-16T21:22:54+0000","dateFinished":"2019-02-16T21:22:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5813"},{"text":"%pyspark\nschema = StructType([\n    StructField(\"Date/Time\", TimestampType(), True),\n    StructField(\"Lat\", DoubleType(), True),\n    StructField(\"Lon\", DoubleType(), True),\n    StructField(\"Base\", StringType(), True)\n])","user":"anonymous","dateUpdated":"2019-02-18T23:50:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550351381144_1425418977","id":"20190216-054830_1348803462","dateCreated":"2019-02-16T21:09:41+0000","dateStarted":"2019-02-18T23:50:33+0000","dateFinished":"2019-02-18T23:50:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5814"},{"text":"%pyspark\nFeatureCol = ['Lat','Lon']\nassembler = VectorAssembler(inputCols=FeatureCol, outputCol=\"features\")\ndf = assembler.transform(df)","user":"anonymous","dateUpdated":"2019-02-18T23:50:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550351381144_454812401","id":"20190216-054832_741989106","dateCreated":"2019-02-16T21:09:41+0000","dateStarted":"2019-02-18T23:50:35+0000","dateFinished":"2019-02-18T23:50:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5815"},{"text":"%pyspark\ndf.show()\n","user":"anonymous","dateUpdated":"2019-02-18T23:50:47+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-------+--------+------+------------------+\n|          Date/Time|    Lat|     Lon|  Base|          features|\n+-------------------+-------+--------+------+------------------+\n|2014-08-01 00:00:00|40.7476|-73.9871|B02598|[40.7476,-73.9871]|\n|2014-08-01 00:00:00|40.7424|-74.0044|B02598|[40.7424,-74.0044]|\n|2014-08-01 00:00:00| 40.751|-73.9869|B02598| [40.751,-73.9869]|\n|2014-08-01 00:00:00|40.7406|-73.9902|B02598|[40.7406,-73.9902]|\n|2014-08-01 00:00:00|40.6994|-73.9591|B02617|[40.6994,-73.9591]|\n|2014-08-01 00:00:00|40.6917|-73.9398|B02617|[40.6917,-73.9398]|\n|2014-08-01 00:00:00|40.7063|-73.9223|B02617|[40.7063,-73.9223]|\n|2014-08-01 00:00:00|40.6759|-74.0168|B02617|[40.6759,-74.0168]|\n|2014-08-01 00:00:00|40.7617|-73.9847|B02617|[40.7617,-73.9847]|\n|2014-08-01 00:00:00|40.6969|-73.9064|B02617|[40.6969,-73.9064]|\n|2014-08-01 00:00:00|40.7623|-73.9751|B02617|[40.7623,-73.9751]|\n|2014-08-01 00:00:00|40.6982|-73.9669|B02617|[40.6982,-73.9669]|\n|2014-08-01 00:00:00|40.7553|-73.9253|B02617|[40.7553,-73.9253]|\n|2014-08-01 00:00:00|40.7325|-73.9876|B02682|[40.7325,-73.9876]|\n|2014-08-01 00:00:00|40.6754| -74.017|B02682| [40.6754,-74.017]|\n|2014-08-01 00:00:00|40.7303|-74.0029|B02682|[40.7303,-74.0029]|\n|2014-08-01 00:00:00|40.7218|-73.9973|B02682|[40.7218,-73.9973]|\n|2014-08-01 00:00:00|40.7134|-74.0091|B02682|[40.7134,-74.0091]|\n|2014-08-01 00:00:00|40.7194|-73.9964|B02682|[40.7194,-73.9964]|\n|2014-08-01 00:00:00| 40.762| -73.983|B02682|  [40.762,-73.983]|\n+-------------------+-------+--------+------+------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=40"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550351381144_1370673147","id":"20190216-190028_1061053239","dateCreated":"2019-02-16T21:09:41+0000","dateStarted":"2019-02-18T23:50:47+0000","dateFinished":"2019-02-18T23:50:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5816"},{"text":"%pyspark\nkm = KMeans().setK(8).setFeaturesCol(\"features\").setPredictionCol(\"prediction\")\nmodel = km.fit(df)","user":"anonymous","dateUpdated":"2019-02-18T23:50:56+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=41","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=42","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=43","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=44","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=45","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=46","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=47","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=48","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=49","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=50","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=51","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=52","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=53","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=54","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=55","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=56","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=57","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=58","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=59","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=60","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=61","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=62","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=63","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=64","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=65","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=66","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=67","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=68"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550351381144_136552186","id":"20190216-054853_1131114825","dateCreated":"2019-02-16T21:09:41+0000","dateStarted":"2019-02-18T23:50:56+0000","dateFinished":"2019-02-18T23:51:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5817"},{"text":"%pyspark\nmodel.save(\"model\")","user":"anonymous","dateUpdated":"2019-02-18T14:45:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=217","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=218","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=219","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=220","http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=221"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550351381145_-2004450209","id":"20190216-192645_96617687","dateCreated":"2019-02-16T21:09:41+0000","dateStarted":"2019-02-16T21:25:26+0000","dateFinished":"2019-02-16T21:25:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5818"},{"text":"%pyspark\ncenters = model.clusterCenters()\n\nprint(\"Cluster Centers: \")\nfor center in centers:\n    print(center)","user":"anonymous","dateUpdated":"2019-02-18T23:55:09+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Cluster Centers: \n[ 40.73117105 -73.99762083]\n[ 40.76793155 -73.97180884]\n[ 40.97795865 -73.80229132]\n[ 40.66004964 -73.78030139]\n[ 40.69991611 -74.20076403]\n[ 40.68641623 -73.96334044]\n[ 40.77939479 -73.88050578]\n[ 40.76862169 -73.45697309]\n"}]},"apps":[],"jobName":"paragraph_1550351381145_-1626724110","id":"20190216-192955_320529035","dateCreated":"2019-02-16T21:09:41+0000","dateStarted":"2019-02-18T23:55:09+0000","dateFinished":"2019-02-18T23:55:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5819"},{"text":"\n%pyspark\ndf_clusters = model.transform(df)\ndf_clusters.show()\n","user":"anonymous","dateUpdated":"2019-02-18T23:55:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-------+--------+------+------------------+----------+\n|          Date/Time|    Lat|     Lon|  Base|          features|prediction|\n+-------------------+-------+--------+------+------------------+----------+\n|2014-08-01 00:00:00|40.7476|-73.9871|B02598|[40.7476,-73.9871]|         0|\n|2014-08-01 00:00:00|40.7424|-74.0044|B02598|[40.7424,-74.0044]|         0|\n|2014-08-01 00:00:00| 40.751|-73.9869|B02598| [40.751,-73.9869]|         0|\n|2014-08-01 00:00:00|40.7406|-73.9902|B02598|[40.7406,-73.9902]|         0|\n|2014-08-01 00:00:00|40.6994|-73.9591|B02617|[40.6994,-73.9591]|         5|\n|2014-08-01 00:00:00|40.6917|-73.9398|B02617|[40.6917,-73.9398]|         5|\n|2014-08-01 00:00:00|40.7063|-73.9223|B02617|[40.7063,-73.9223]|         5|\n|2014-08-01 00:00:00|40.6759|-74.0168|B02617|[40.6759,-74.0168]|         5|\n|2014-08-01 00:00:00|40.7617|-73.9847|B02617|[40.7617,-73.9847]|         1|\n|2014-08-01 00:00:00|40.6969|-73.9064|B02617|[40.6969,-73.9064]|         5|\n|2014-08-01 00:00:00|40.7623|-73.9751|B02617|[40.7623,-73.9751]|         1|\n|2014-08-01 00:00:00|40.6982|-73.9669|B02617|[40.6982,-73.9669]|         5|\n|2014-08-01 00:00:00|40.7553|-73.9253|B02617|[40.7553,-73.9253]|         1|\n|2014-08-01 00:00:00|40.7325|-73.9876|B02682|[40.7325,-73.9876]|         0|\n|2014-08-01 00:00:00|40.6754| -74.017|B02682| [40.6754,-74.017]|         5|\n|2014-08-01 00:00:00|40.7303|-74.0029|B02682|[40.7303,-74.0029]|         0|\n|2014-08-01 00:00:00|40.7218|-73.9973|B02682|[40.7218,-73.9973]|         0|\n|2014-08-01 00:00:00|40.7134|-74.0091|B02682|[40.7134,-74.0091]|         0|\n|2014-08-01 00:00:00|40.7194|-73.9964|B02682|[40.7194,-73.9964]|         0|\n|2014-08-01 00:00:00| 40.762| -73.983|B02682|  [40.762,-73.983]|         1|\n+-------------------+-------+--------+------+------------------+----------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-81-68.ec2.internal:4040/jobs/job?id=69"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550351381145_-202937915","id":"20190216-055744_359033849","dateCreated":"2019-02-16T21:09:41+0000","dateStarted":"2019-02-18T23:55:54+0000","dateFinished":"2019-02-18T23:55:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5820"},{"text":"%pyspark\ndf_clusters.registerTempTable(\"uber\") ","user":"anonymous","dateUpdated":"2019-02-18T23:56:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550351381145_1597248289","id":"20190216-055820_1184671327","dateCreated":"2019-02-16T21:09:41+0000","dateStarted":"2019-02-18T23:56:54+0000","dateFinished":"2019-02-18T23:56:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5821"}],"name":"K-means model","id":"2E5S3BYSF","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}